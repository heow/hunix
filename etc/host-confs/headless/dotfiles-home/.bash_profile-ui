#!/bin/sh
# UI mods

# settings
set -o emacs					# emacs mode!
set -o ignoreeof				# no ^D to lo

# previously in .inputrc
bind '"\C-o": backward-word'
bind '"\C-u": forward-word'

# can we use advanced settings?
if [ -n "$BASH_VERSINFO" ]; then
	shopt -s cdable_vars			# cd to env var
	shopt -s cdspell			    # fix cd spelling
	shopt -s checkwinsize			# dynamically change LINE and WIDTH
	shopt -s hostcomplete			# complete @yaho
	shopt -s interactive_comments   # ignore #
fi

#export CDPATH=~/prj:~/				# automagically cd to
export FIGNORE=".o:~"				# dont expand
export HISTCONTROL=ignoreboth			# hist ignore dups and spaces

#	editor
export ALTERNATE_EDITOR=emacs 
export EDITOR=emacsclient 
export VISUAL=emacsclient
export FCEDIT=$EDITOR
export PAGER=less

# most aliases were made into files so they could be run without readline
alias rm!='/bin/rm'
#alias rm='~/bin/rmsafe'
alias lo='exit'
alias bye='exit'
alias pd='pushd'
alias pd2='pushd +2'
alias pd3='pushd +3'
alias pd4='pushd +4'
alias ls='ls -G -F $*'
alias o='ls -G -F $*'
alias oo='ls -lF $*'
alias od='ls -d */'
alias ood='ls -l */'
alias oot='ls -lLFrt $*'
alias grep='grep --color'
#alias psme='ps aux | grep $USER'
#alias print='pdq'
#alias screen='screen -e^Xx -l -R'
#alias emacs='~/bin/emacs-local/bin/emacs'

# set up prompt and keyboard
# modifiers
#   0; none		1; bold		4; underscore
#	5; blink	7; reverse	8; concealed
# colors (30 foreground, 40 background)
# 	;30 black	;31 red		;32 green	;33 yellow	
# 	;34 blue	;35 pink	;36 lt blue	;37 white
# commands
# 	\d date		\H hostname \h hn short	\n CRLF
#	\u user		\w dir		\W PWD		\# command number
#	\! hist num \@ time 12	\t HHMMSS	\T HHMMSS 12

#export PS1='\n\h \! \033[0;32m\w\n$ \033[m'
#export PS1='\n\h \! \033[0;32m \w\n$ '
#export PS2='\! \033[1;34mmore\033[1;30m $ \033[m'

#export PS1='\[\e]1;My Desk\a\e]2;${PWD}\a\e[0;32m\][\u@\h \w]\n\#\$ \[\e[m\]'
#export PS1='\[\e]1;\a\e]2;${PWD}\a\u@\h \e[0;32m\w\n\$ \[\e[m\]'
#export PS1='\n\u@\h:\e[0;32m\w\n\$ \[\e[m\]'
export PS1='\n\u@\H\e[0;30m:\e[0;32m\w\n\$ \[\e[m\]'

# Support for .enter.sh and .exit.sh
cd() {
    test -O .exit.sh && . .exit.sh
    if [ -n "$1" ]; then
    	case "$1" in
        ...)       builtin cd "../..";;
        ....)      builtin cd "../../..";;
        .....)     builtin cd "../../../..";;        
        ......)    builtin cd "../../../../..";;
        .......)   builtin cd "../../../../../..";;
        ........)  builtin cd "../../../../../../..";;
        .........) builtin cd "../../../../../../../..";;
        ..........)builtin cd "../../../../../../../../..";;
        *) builtin cd "$1"
        esac
    else 
    	builtin cd
    fi
    test -O .enter.sh && . .enter.sh
}

# use ^o for something useful
if ( stty -a | grep -w discard > /dev/null ); then
	stty discard ""
fi

if ( stty -a | grep -w flush > /dev/null ); then
	stty flush ""
fi

# gotta have funnies
if [ -x /usr/games/fortune ]; then
	# fun and games 25% of the time
	num=$(($RANDOM%4+1))
	if [ $num = "1" ]; then
		echo
		/usr/games/fortune
	fi
fi

